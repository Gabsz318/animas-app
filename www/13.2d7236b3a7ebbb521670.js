(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"tx+c":function(o,n,t){"use strict";t.r(n),t.d(n,"BookingsPageModule",function(){return h});var i=t("ofXK"),e=t("3Pt+"),a=t("TEn/"),b=t("tyNb"),c=t("mrSG"),s=t("fXoL"),r=t("I/3d"),l=t("UbJi");function d(o,n){if(1&o){const o=s.Sb();s.Rb(0,"ion-item",14),s.Zb("click",function(){s.hc(o);const t=n.$implicit;return s.bc().editBooking(t.id)}),s.Rb(1,"ion-label"),s.mc(2),s.Nb(3,"br"),s.mc(4),s.Nb(5,"br"),s.mc(6),s.Nb(7,"br"),s.Qb(),s.Qb()}if(2&o){const o=n.$implicit;s.Cb(2),s.oc(" ",o.clientName," "),s.Cb(2),s.pc(" ",o.formattedStartDate," - ",o.formattedEndDate," "),s.Cb(2),s.oc(" Caba\xf1a ",o.cabinName," ")}}function u(o,n){1&o&&(s.Rb(0,"ion-tab-button",16),s.Rb(1,"ion-label"),s.mc(2,"Caba\xf1as"),s.Qb(),s.Nb(3,"ion-icon",17),s.Qb())}function g(o,n){1&o&&(s.Rb(0,"ion-tab-button",18),s.Rb(1,"ion-label"),s.mc(2,"Promos"),s.Qb(),s.Nb(3,"ion-icon",19),s.Qb())}const m=[{path:"",component:(()=>{class o{constructor(o,n,t){this.ngFirestore=o,this.angularFireAuth=n,this.router=t}ngOnInit(){return Object(c.b)(this,void 0,void 0,function*(){let o,n;this.angularFireAuth.authState.subscribe(o=>this.isBookingUser=o.email.endsWith("@captura.com")),this.ngFirestore.collection("cabins").snapshotChanges().subscribe(o=>n=o.map(o=>Object.assign({id:o.payload.doc.id},o.payload.doc.data()))),this.ngFirestore.collection("clients").snapshotChanges().subscribe(n=>o=n.map(o=>Object.assign({id:o.payload.doc.id},o.payload.doc.data()))),this.ngFirestore.collection("bookings").snapshotChanges().subscribe(t=>{console.log(n,o),this.bookings=t.map(t=>Object.assign({id:t.payload.doc.id,cabinName:n.find(o=>o.$key===t.payload.doc.data().cabin_id),clientName:o.find(o=>o.$key===t.payload.doc.data().client_id),formattedStartDate:new Date(t.payload.doc.data().start_date).toLocaleDateString(),formattedEndDate:new Date(t.payload.doc.data().end_date).toLocaleDateString()},t.payload.doc.data()))})})}addBooking(){this.router.navigate(["bookings/booking-form"])}logout(){return Object(c.b)(this,void 0,void 0,function*(){yield this.angularFireAuth.signOut(),this.router.navigate(["login"])})}editBooking(o){this.router.navigate([`bookings/booking-form/${o}`])}}return o.\u0275fac=function(n){return new(n||o)(s.Mb(r.a),s.Mb(l.a),s.Mb(b.g))},o.\u0275cmp=s.Gb({type:o,selectors:[["app-bookings"]],decls:29,vars:4,consts:[[1,"custom-background"],[3,"click",4,"ngFor","ngForOf"],["horizontal","end","vertical","bottom","slot","fixed"],["color","tertiary",3,"click"],["name","add"],["slot","bottom"],[3,"href"],["name","home-outline"],["href","cabins",4,"ngIf"],["href","bookings"],["name","ticket-outline"],["href","clients"],["name","people-outline"],["href","disccounts",4,"ngIf"],[3,"click"],["name","log-out-outline"],["href","cabins"],["name","cabin"],["href","disccounts"],["name","disccount"]],template:function(o,n){1&o&&(s.Rb(0,"ion-header"),s.Rb(1,"ion-toolbar",0),s.Rb(2,"ion-title"),s.mc(3,"Reservas"),s.Qb(),s.Qb(),s.Qb(),s.Rb(4,"ion-content"),s.Rb(5,"ion-list"),s.lc(6,d,8,4,"ion-item",1),s.Qb(),s.Rb(7,"ion-fab",2),s.Rb(8,"ion-fab-button",3),s.Zb("click",function(){return n.addBooking()}),s.Nb(9,"ion-icon",4),s.Qb(),s.Qb(),s.Qb(),s.Rb(10,"ion-tab-bar",5),s.Rb(11,"ion-tab-button",6),s.Rb(12,"ion-label"),s.mc(13,"Inicio"),s.Qb(),s.Nb(14,"ion-icon",7),s.Qb(),s.lc(15,u,4,0,"ion-tab-button",8),s.Rb(16,"ion-tab-button",9),s.Rb(17,"ion-label"),s.mc(18,"Reservas"),s.Qb(),s.Nb(19,"ion-icon",10),s.Qb(),s.Rb(20,"ion-tab-button",11),s.Rb(21,"ion-label"),s.mc(22,"Clientes"),s.Qb(),s.Nb(23,"ion-icon",12),s.Qb(),s.lc(24,g,4,0,"ion-tab-button",13),s.Rb(25,"ion-tab-button",14),s.Zb("click",function(){return n.logout()}),s.Rb(26,"ion-label"),s.mc(27,"Salir"),s.Qb(),s.Nb(28,"ion-icon",15),s.Qb(),s.Qb()),2&o&&(s.Cb(6),s.ec("ngForOf",n.bookings),s.Cb(5),s.fc("href",n.isBookingUser?"home-bookings":"home-admin"),s.Cb(4),s.ec("ngIf",!n.isBookingUser),s.Cb(9),s.ec("ngIf",!n.isBookingUser))},directives:[a.r,a.I,a.H,a.m,a.x,i.i,a.o,a.p,a.s,a.D,a.E,a.w,i.j,a.v],styles:[""]}),o})()},{path:"booking-form",loadChildren:()=>Promise.all([t.e(0),t.e(12)]).then(t.bind(null,"VItk")).then(o=>o.BookingFormPageModule)}];let f=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=s.Kb({type:o}),o.\u0275inj=s.Jb({imports:[[b.i.forChild(m)],b.i]}),o})(),h=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=s.Kb({type:o}),o.\u0275inj=s.Jb({imports:[[i.c,e.a,a.J,f]]}),o})()}}]);